<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=
    , initial-scale=1.0">
    <script src="https://checkout.flutterwave.com/v3.js"></script>
    <title>Upgrade</title>
    <style>
        .loading{
            width: 100%;
            height: 100vh;
            background-color: #000;
            position: fixed;
            top:0;
            z-index: 2000 !important;
            display: grid;
            place-items: center;
            color: white;
        }
        .rotate-center {
            -webkit-animation: rotate-center 0.6s linear infinite both;
            animation: rotate-center 0.6s linear infinite both;
            width: 50px;
            height: 50px;
            background-color: transparent;
            border-left: 4px solid white;
            border-bottom: 4px solid transparent;
            border-top: 4px solid transparent;
            border-right:4px solid transparent;
            border-radius:50px;
            margin-bottom: 20px;
        }
                /* ----------------------------------------------
        * Generated by Animista on 2020-11-22 21:23:47
        * Licensed under FreeBSD License.
        * See http://animista.net/license for more info. 
        * w: http://animista.net, t: @cssanimista
        * ---------------------------------------------- */

        /**
        * ----------------------------------------
        * animation rotate-center
        * ----------------------------------------
        */
        @-webkit-keyframes rotate-center {
        0% {
            -webkit-transform: rotate(0);
                    transform: rotate(0);
        }
        100% {
            -webkit-transform: rotate(360deg);
                    transform: rotate(360deg);
        }
        }
        @keyframes rotate-center {
        0% {
            -webkit-transform: rotate(0);
                    transform: rotate(0);
        }
        100% {
            -webkit-transform: rotate(360deg);
                    transform: rotate(360deg);
        }
        }
    </style>
</head>
<body>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
</body>

<script>


function pay(){
  var PBFKey = "FLWPUBK_TEST-6d8586b2aa1c61a02f1853acf364e3f8-X";
  // getpaidSetup is Rave's inline script function. it holds the payment data to pass to Rave.
  FlutterwaveCheckout({
   public_key: PBFKey,
   tx_ref: 'RF-DP-'+new Date().getFullYear()+'-'+new Date().getMonth() + 1+'-'+new Date().getDay()+'_'+new Date().getHours()+'_'+new Date().getMinutes()+'_'+ new Date().getSeconds(),
   amount: '{{data.amount}}',
   currency: 'GHS',
   country: 'GH',
   payment_options: "card, mobilemoneyghana, ussd",
   // redirect_url: window.location.origin+'/verifyT',
   meta: {
     consumer_id: '{{data.user_id}}',
     consumer_mac: "92a3-912ba-1192a",
   },
   customer: {
     email: '{{data.email}}',
     phone_number: '{{data.phonenumber}}',
     name: '{{data.username}}',
   },
   callback: function (data) {
       
        $('body').prepend(`<div class="loading">
            <div>
                <div class="rotate-center"></div>
                <center>Please wait....</center>
            </div>
        </div>`);
        $('iframe').css('height','0px');
        var url = `${window.location.protocol}//${window.location.host}/api/verifyT/${data.status}/${data.tx_ref}/${data.transaction_id}/{{data.user_id}}/{{data.duration}}`;
        $.get(url,function(res,status){
         
          if(res == "success"){
            
            $('.loading').html(`<div>Account upgraded</div>`);
            setTimeout(function(){
                window.close();
            },1000);
          }
        })
   },
   onclose: function() {
      window.close();
   },
   customizations: {
     title: "Das Prediction",
     description: "Application upgrade",
     logo: "https://dasapp.biztrustgh.com/ic_launcher_round2.png",
   },
 });

}
pay();
</script>
</html>